@page "/"

@using Core.Domain.AggregateRoots.Manager;
@using EMS.Witness.Pages.Witness.Components
@using EMS.Witness.Services;
@inject IParticipantsService ArrivelistService;

<div class="accordion">
    <div class="accordion-item">
        <h2 class="accordion-header">
            <button class="accordion-button @this.participantsButtonCss" type="button" @onclick="this.ToggleArrivelist">
                Record Arrive Time
            </button>
        </h2>
        <div id="arrivelist-content" class="accordion-collapse collapse @this.participantsCss" aria-labelledby="arrivelist-header">
            <div class="accordion-body">
                <SnapshotComponent />
            </div>
        </div>
    </div>
    <div class="accordion-item">
        <h2 id="edit-form-header" class="accordion-header">
            <button class="accordion-button @this.arriveFormButtonCss" type="button" @onclick="this.ToggleArriveForm">
                Save (Edit) Time
            </button>
        </h2>
        <div id="edit-form-content" class="accordion-collapse collapse @arriveFormCss" aria-labelledby="edit-form-header">
            <div class="accordion-body">
                <SaveFormComponent />
            </div>
        </div>
    </div>
    <div class="accordion-item">
        <h2 id="edit-form-header" class="accordion-header">
            <button class="accordion-button @this.historyButtonCss" type="button" @onclick="this.ToggleHistory">
                History
            </button>
        </h2>
        <div id="edit-form-content" class="accordion-collapse collapse @historyCss" aria-labelledby="edit-form-header">
            <div class="accordion-body">
                <HistoryComponent />
            </div>
        </div>
    </div>
</div>

@code {
    private string participantsButtonCss = "";
    private string participantsCss = "show";
    private string arriveFormButtonCss = "collapsed";
    private string arriveFormCss = "";
    private string historyButtonCss = "collapsed";
    private string historyCss = "";

    public void ToggleArrivelist()
    {
        if (this.participantsCss == "show")
        {
            this.participantsCss = "";
            this.participantsButtonCss = "collapsed";
        }
        else
        {
            this.participantsCss = "show";
            this.participantsButtonCss = "";
        }
    }

    public void ToggleArriveForm()
    {
        if (this.arriveFormCss == "show")
        {
            this.arriveFormCss = "";
            this.arriveFormButtonCss = "collapsed";
        }
        else
        {
            this.arriveFormCss = "show";
            this.arriveFormButtonCss = "";
        }
    }

    public void ToggleHistory()
    {
        if (this.historyCss == "show")
        {
            this.historyCss = "";
            this.historyButtonCss = "collapsed";
        }
        else
        {
            this.historyCss = "show";
            this.historyButtonCss = "";
        }
    }

    // Necessary for EditForm, which is necessary for InputSelect
    private object Model { get; } = new();
}