@using Common.Application;
@using Common.Application.CRUD;
@using Common.Domain;
@using Common.Services;
@using Not.Blazor.Forms;

@typeparam T where T : DomainEntity;
@typeparam TForm where TForm : NotFormFields<T>;

@* 
    Replace IRepository<T> with ICreateBehind<T> and remove CreateChildDialog as it is no longer necessary as
    ICreateBehind will abstrat it away and dialogs no longer need to know if they entity is parent, child or not
*@
@inject IRepository<T> _repository;

<InternalCreateDialog T="T" TForm="TForm" OnCreate="OnCreate" />

@code {
    [CascadingParameter]
    protected MudDialogInstance Dialog { get; set; } = default!;

    protected async Task OnCreate(T entity)
    {
        await _repository.Create(entity);
        Dialog.Close(DialogResult.Ok(true));
    }
}