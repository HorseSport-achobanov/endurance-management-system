@using NTS.Judge.Blazor.Shared.Components.SidePanels.RFID

@inherits NComponent

<MudStack Class="ma-6">
    @if (!_enduranceEventStarted)
    {
        <NButtonPrimary OnClick="Start" Text="Start Endurance Event" />
    }
    else
    {
        <RfidPanel EnduranceEventStarted="_enduranceEventStarted" />
    }
</MudStack>

@code {
    [Inject]
    private ICoreBehind CoreBehind { get; set; } = default!;
    bool _enduranceEventStarted;

    protected override async Task OnInitializedAsync()
    {
        _enduranceEventStarted = await CoreBehind.IsStarted();
    }

    public async void Start()
    {
        // TODO make sure that DashboardPage, RanklistPage and HandoutsPage rerender if active
        _enduranceEventStarted = await CoreBehind.Start();
        await InvokeAsync(StateHasChanged);
    }
}
