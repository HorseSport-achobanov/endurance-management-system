@using NTS.Domain.Objects
@using NTS.Judge.Blazor.Ports;
@using Not.Blazor.TM
@using Not.Notifier

@inherits NotComponent

<MudStack Class="ma-6">
    @if (_enduranceEventStarted)
    {
        <NotButtonPrimary OnClick="_reader.NotifyStatus" Text="Get Status"/>
    }
    else
    {
        <NotButtonPrimary OnClick="Start" Text="@StartMessage"/>
    }
</MudStack>

@code {
    [Inject]
    private IDashboardBehind _dashboardBehind { get; set; } = default!;
    [Inject]
    private IRfidReaderBehind _reader { get; set; } = default!;
    private bool _enduranceEventStarted;
    private string StartMessage => _enduranceEventStarted ? "Reconnect" : "Start Endurance Event";

    public async void Start()
    {
        _enduranceEventStarted = true;
        _reader.StartReading();
        await _dashboardBehind.Start();
    }
}