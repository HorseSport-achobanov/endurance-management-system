@using NTS.Domain.Core.Aggregates.Participations
@using NTS.Judge.Blazor.Enums
@using NTS.Judge.Blazor.Pages.Dashboard.Components.Actions.EliminationForms
@using NTS.Judge.Blazor.Ports
@using Not.Structures

@inherits NotComponent

<h4>Eliminations Panel</h4>

<MudPaper Class="d-flex flex-column mb-2" Elevation="0">
    <MudToggleGroup @ref="toggleGroup" T="string" TextClass="@SmallTextClass" Delimiters="true" Color="Color.Error" Rounded="true"
                    SelectionMode="SelectionMode.ToggleSelection" Style="width: 20rem" ValueChanged="OnToggle" Value="ToggleGroupSelection">
        <MudToggleItem Text="Withdrawn" Value="@("WD")" />
        <MudToggleItem Text="Retired" Value="@("RET")" />
        <MudToggleItem Text="Finished Not Ranked" Value="@("FNR")" />
        <MudToggleItem Text="Disqualified" Value="@("DQ")" />
        <MudToggleItem Text="Failed to Qualify" Value="@("FTQ")" />
    </MudToggleGroup>
    <MudCollapse Expanded="@(ToggleGroupSelection=="WD")">
        <WithdrawForm />
    </MudCollapse>
    <MudCollapse Expanded="@(ToggleGroupSelection=="RET")">
        <RetireForm/>
    </MudCollapse>
    <MudCollapse Expanded="@(ToggleGroupSelection=="FNR")">
        <FinishNotRankedForm/>
    </MudCollapse>
    <MudCollapse Expanded="@(ToggleGroupSelection=="DQ")">
        <DisqualifyForm/>
    </MudCollapse>
    <MudCollapse Expanded="@(ToggleGroupSelection=="FTQ")">
        <FailedToQualifyForm/>
    </MudCollapse>
</MudPaper>

@code {
    [Inject]
    IParticipationBehind _participationBehind { get; set; } = default!;

    private MudToggleGroup<string> toggleGroup = default!;
    private Participation _selectedParticipation = default!;

    private string SmallTextClass = "font-size-10";
    private string ToggleGroupSelection = "";

    protected override async Task OnInitializedAsync()
    {
        await Observe(_participationBehind);
    }

    public void OnToggle(string value)
    {
        ToggleGroupSelection = value;
    }
}
