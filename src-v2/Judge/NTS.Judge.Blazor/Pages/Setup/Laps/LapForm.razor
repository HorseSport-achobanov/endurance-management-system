@using NTS.Domain.Setup.Entities;
@using NTS.Judge.Setup.Competitions
@using Not.Blazor.Forms;
@using Not.Blazor.TM.Forms;
@using Not.Blazor.TM.Forms.Components;

@inherits NotForm<Lap>;

<EditForm Model="_model">
    <MudNumericField @bind-Value="_model.Distance" Label="Lap" />
</EditForm>

@code {
    private MudNumericField<double> _distanceField = default!;
    private LapFormModel _model { get; set; } = new();

    public override void RegisterValidationInjectors()
    {
        RegisterInjector(nameof(_model.Distance), () => _distanceField);
    }

    public override void SetUpdateModel(Lap lap)
    {
        _model = new LapFormModel(lap);
    }

    public override Lap SubmitCreate()
    {
        return Lap.Create(_model.Distance);
    }

    public override Lap SubmitUpdate()
    {
        return Lap.Update(_model.Id, _model.Distance);
    }
}