@using NTS.Domain.Setup.Entities
@using NTS.Judge.Blazor.Pages.Setup.Athletes
@using NTS.Judge.Blazor.Pages.Setup.Events
@using NTS.Judge.Blazor.Pages.Setup.Loops
@using NTS.Judge.Blazor.Pages.Setup.Officials
@using NTS.Judge.Blazor.Pages.Setup.Competitions
@using NTS.Judge.Blazor.Pages.Setup.Contestants
@using NTS.Judge.Blazor.Pages.Setup.Horses
@using NTS.Judge.Blazor.Pages.Setup.Combinations
@using Not.Blazor.TM
@using Not.Blazor.TM.Forms.Components

@inherits NotComponent

<MudPaper Elevation="0" Class="pa-6">
    <NotH2>Update Event</NotH2>
    <NotFormUpdate T="Event" TForm="EventForm" Entity="_event" UpdateAction="_behind.Update" />
</MudPaper>

<MudDivider />

<MudPaper Class="d-flex justify-space-between pr-6" Elevation="0">
    <NotSetList Name="Officials" T="Official" TForm="OfficialForm" UpdateRoute="@OFFICIAL_UPDATE" />
    <MudDivider Vertical="true" FlexItem="true" />
    <NotSetList Name="Loops" T="Loop" TForm="LoopForm" UpdateRoute="@LOOP_UPDATE" />
</MudPaper>

<MudDivider />

<MudPaper Class="d-flex justify-space-between pr-6" Elevation="0">
    <NotSetList Name="Athletes" T="Athlete" TForm="AthleteForm" UpdateRoute="@ATHLETE_UPDATE" />
    <MudDivider Vertical="true" FlexItem="true" />
    <NotSetList Name="Horses" T="Horse" TForm="HorseForm" UpdateRoute="@HORSE_UPDATE" />
</MudPaper>

<MudDivider />

<MudPaper Class="d-flex justify-space-between pr-6" Elevation="0">
    <NotSetList Name="Combinations" T="Combination" TForm="CombinationForm" UpdateRoute="@COMBINATION_UPDATE"/>
</MudPaper>

<MudDivider />

<MudPaper Elevation="0">
   <CompetitionGrid />
</MudPaper>


@code {
    private Event _event = default!;
    [Inject]
    private INotBehind<Event> _behind { get; set; } = default!;

    protected override async Task OnInitializedAsync()
    {
        var @event = await _behind.Read(default);
        GuardHelper.ThrowIfDefault(@event);

        _event = @event;
        await _behind.Initialize(_event.Id);
    }
}