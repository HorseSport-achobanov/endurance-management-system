@using NTS.Domain.Setup.Entities
@using NTS.Judge.Blazor.Pages.Setup.Events
@using NTS.Judge.Blazor.Pages.Setup.Officials
@using NTS.Judge.Blazor.Pages.Setup.Competitions
@using NTS.Judge.Blazor.Pages.Setup.Contestants
@using Not.Blazor.TM.Forms.Components

@inherits NotComponent

<MudPaper Class="pa-6">
    <NotH2>Update Event</NotH2>
    <NotFormUpdate T="Event" TForm="EventForm" Entity="_event" UpdateAction="_behind.Update" />
</MudPaper>

<MudDivider />

<MudPaper Class="pa-6">
    <OfficialList />
</MudPaper>

<MudDivider />

<MudPaper>
   <CompetitionGrid/>
</MudPaper>

<MudPaper>
    <ContestantGrid />
</MudPaper>

@code {
    private Event _event = default!;
    [Inject]
    private INotBehind<Event> _behind { get; set; } = default!;

    protected override async Task OnInitializedAsync()
    {
        var entity = await _behind.Read(default);
        if (entity == null)
        {
            throw GuardHelper.Exception($"Event cannot be null here");
        }
        await _behind.Initialize(entity.Id);
        _event = entity;
    }
}